DEBUG:tensorflow:Layer gru will use cuDNN kernels when running on GPU.
DEBUG:tensorflow:Layer gru_1 will use cuDNN kernels when running on GPU.
DEBUG:tensorflow:Layer gru_2 will use cuDNN kernels when running on GPU.
DEBUG:tensorflow:Layer gru_3 will use cuDNN kernels when running on GPU.
DEBUG:tensorflow:Layer gru_4 will use cuDNN kernels when running on GPU.
INFO:checkpoint_logger:[CHECKPOINT-Main] üöÄ Start simulation | Seed=42
INFO:checkpoint_logger:[CHECKPOINT-Traffic] üö¶ Start traffic simulation
INFO:checkpoint_logger:[CHECKPOINT-Traffic] üìÖ Period=morning | Œª_base=100 | Hours=8
INFO:checkpoint_logger:[CHECKPOINT-Traffic] üßÆ Period=morning completed | Final active users=32
INFO:checkpoint_logger:[CHECKPOINT-Traffic] üìÖ Period=noon | Œª_base=150 | Hours=4
INFO:checkpoint_logger:[CHECKPOINT-Traffic] üßÆ Period=noon completed | Final active users=32
INFO:checkpoint_logger:[CHECKPOINT-Traffic] üìÖ Period=evening | Œª_base=120 | Hours=12
INFO:checkpoint_logger:[CHECKPOINT-Traffic] üßÆ Period=evening completed | Final active users=32
INFO:checkpoint_logger:[CHECKPOINT-Traffic] ‚úÖ Simulation done | Simulated TotalTime=24.00 hrs
INFO:checkpoint_logger:[CHECKPOINT-Main] üìä Traffic simulation completed | total_time=24.00 hrs
INFO:checkpoint_logger:[CHECKPOINT-Main] üïí Period=morning Start
INFO:checkpoint_logger:[CHECKPOINT-Main] üë• Users in morning: 32
INFO:checkpoint_logger:[CHECKPOINT-2] Task=Static | Raw |h| mean=0.01218 | shape=(16, 32, 64)
INFO:checkpoint_logger:[CHECKPOINT-3] Task=Static | Normalized |h| mean=0.99992
INFO:root:[Static] üìè Normalized |h| mean: 0.99992
INFO:root:[Static] üìä Std(|h|): 0.61041
INFO:root:[Static] üìê Shape: (16, 32, 64)
INFO:checkpoint_logger:[CHECKPOINT-2] Task=Pedestrian | Raw |h| mean=0.89003 | shape=(16, 32, 64)
INFO:checkpoint_logger:[CHECKPOINT-3] Task=Pedestrian | Normalized |h| mean=1.00000
INFO:root:[Pedestrian] üìè Normalized |h| mean: 1.00000
INFO:root:[Pedestrian] üìä Std(|h|): 0.52395
INFO:root:[Pedestrian] üìê Shape: (16, 32, 64)
INFO:checkpoint_logger:[CHECKPOINT-2] Task=Vehicular | Raw |h| mean=0.01158 | shape=(16, 32, 64)
INFO:checkpoint_logger:[CHECKPOINT-3] Task=Vehicular | Normalized |h| mean=0.99991
INFO:root:[Vehicular] üìè Normalized |h| mean: 0.99991
INFO:root:[Vehicular] üìä Std(|h|): 0.54674
INFO:root:[Vehicular] üìê Shape: (16, 32, 64)
INFO:checkpoint_logger:[CHECKPOINT-2] Task=Aerial | Raw |h| mean=0.01199 | shape=(16, 32, 64)
INFO:checkpoint_logger:[CHECKPOINT-3] Task=Aerial | Normalized |h| mean=0.99992
INFO:root:[Aerial] üìè Normalized |h| mean: 0.99992
INFO:root:[Aerial] üìä Std(|h|): 0.54181
INFO:root:[Aerial] üìê Shape: (16, 32, 64)
INFO:checkpoint_logger:[CHECKPOINT-Main] ‚úÖ Channel generation done for all tasks in morning
INFO:checkpoint_logger:[CHECKPOINT-Main] üîÅ Epoch=1 start for morning
WARNING:tensorflow:You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
WARNING:tensorflow:5 out of the last 5 calls to <function _BaseOptimizer._update_step_xla at 0x7676d35d1c60> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:6 out of the last 6 calls to <function _BaseOptimizer._update_step_xla at 0x7676d35d1c60> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
INFO:checkpoint_logger:[CHECKPOINT-Main] [Epoch 1 | Task=Static] mean|w|: 0.10989
INFO:checkpoint_logger:[CHECKPOINT-Main] [Epoch 1 | Task=Static] mean|h|: 1.63811
INFO:checkpoint_logger:[CHECKPOINT-Main] [Epoch 1 | Task=Static] loss: 96.08854, snr: 0.03234, sinr_db: -14.90
INFO:checkpoint_logger:[CHECKPOINT-Main] üîö End of Epoch=1 | Task=Static | Loss=96.09 | SINR=-14.90dB
WARNING:tensorflow:You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
WARNING:tensorflow:You are casting an input of type complex64 to an incompatible dtype float32.  This will discard the imaginary part and may not be what you intended.
ERROR:root:Traceback (most recent call last):
ERROR:root:File "/home/tanglab/Desktop/BF-CL/main8.py", line 658, in <module>
ERROR:root:main(42)
ERROR:root:File "/home/tanglab/Desktop/BF-CL/main8.py", line 583, in main
ERROR:root:loss, snr_val, mean_w, mean_h, sinr_db_val, loss_val = train_step(
ERROR:root:File "/home/tanglab/Desktop/BF-CL/main8.py", line 509, in train_step
ERROR:root:tf.debugging.check_numerics(g, message=f"Gradient for {v.name} contains nan or Inf")
ERROR:root:File "/home/tanglab/miniconda3/envs/BF-CL/lib/python3.10/site-packages/tensorflow/python/ops/weak_tensor_ops.py", line 88, in wrapper
ERROR:root:return op(*args, **kwargs)
ERROR:root:File "/home/tanglab/miniconda3/envs/BF-CL/lib/python3.10/site-packages/tensorflow/python/ops/gen_array_ops.py", line 994, in check_numerics
ERROR:root:_ops.raise_from_not_ok_status(e, name)
ERROR:root:File "/home/tanglab/miniconda3/envs/BF-CL/lib/python3.10/site-packages/tensorflow/python/framework/ops.py", line 5883, in raise_from_not_ok_status
ERROR:root:raise core._status_to_exception(e) from None  # pylint: disable=protected-access
ERROR:root:tensorflow.python.framework.errors_impl
ERROR:root:.
ERROR:root:InvalidArgumentError
ERROR:root::
ERROR:root:{{function_node __wrapped__CheckNumerics_device_/job:localhost/replica:0/task:0/device:GPU:0}} Gradient for conv1d/kernel:0 contains nan or Inf : Tensor had NaN values [Op:CheckNumerics] name:
